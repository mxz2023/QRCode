// å®šä¹‰å†…å®¹é¡¹æŽ¥å£
interface ContentItem {
  title: string;
  time: string;
}

@Entry
@Component
struct ContentPage {
  @State currentTab: number = 0;
  @State selectedFilter: number = 1;

  // æ¨¡æ‹Ÿæ•°æ®
  private contentItems: ContentItem[] = [
    { title: "è®¾è®¡çµæ„Ÿ", time: "ä»Šå¤©æ›´æ–°" },
    { title: "å¼€å‘æŠ€å·§", time: "æ˜¨å¤©æ›´æ–°" },
    { title: "æœ€ä½³å®žè·µ", time: "2å¤©å‰æ›´æ–°" },
    { title: "UIç»„ä»¶", time: "ä»Šå¤©æ›´æ–°" },
    { title: "æ€§èƒ½ä¼˜åŒ–", time: "æ˜¨å¤©æ›´æ–°" },
    { title: "å®‰å…¨æŒ‡å—", time: "2å¤©å‰æ›´æ–°" },
    { title: "æµ‹è¯•æ–¹æ³•", time: "ä»Šå¤©æ›´æ–°" },
    { title: "éƒ¨ç½²ç­–ç•¥", time: "æ˜¨å¤©æ›´æ–°" },
    { title: "ç›‘æŽ§å·¥å…·", time: "2å¤©å‰æ›´æ–°" },
    { title: "æ–‡æ¡£è§„èŒƒ", time: "ä»Šå¤©æ›´æ–°" },
    { title: "å›¢é˜Ÿåä½œ", time: "æ˜¨å¤©æ›´æ–°" },
    { title: "ç‰ˆæœ¬ç®¡ç†", time: "2å¤©å‰æ›´æ–°" }
  ];

  // è¿‡æ»¤å™¨æ ‡ç­¾
  private filterLabels: string[] = ["å…¨éƒ¨", "è®¾è®¡", "å¼€å‘", "æµ‹è¯•", "éƒ¨ç½²", "æ–‡æ¡£", "å›¢é˜Ÿ", "å·¥å…·", "å®‰å…¨", "æ€§èƒ½"];

  build() {
    Column() {
      // çŠ¶æ€æ 
      this.StatusBar()
      
      // æ ‡é¢˜æ 
      this.TitleBar()
      
      // è¿‡æ»¤å™¨æ ‡ç­¾æ 
      this.FilterBar()
      
      // æ“ä½œæŒ‰é’®åŒºåŸŸ
      this.ActionButtons()
      
      // å†…å®¹ç½‘æ ¼
      this.ContentGrid()
      
      // åº•éƒ¨å¯¼èˆªæ 
      this.BottomNavigation()
      
      // åº•éƒ¨æŒ‡ç¤ºå™¨
      this.BottomIndicator()
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#FEF7FF')
  }

  // çŠ¶æ€æ ç»„ä»¶
  @Builder StatusBar() {
    Row() {
      Text('9:30')
        .fontSize(14)
        .fontWeight(FontWeight.Medium)
        .fontColor('#1D1B20')
        .margin({ left: 24, top: 22 })
      
      Row() {
        Text('ðŸ“¶')
          .fontSize(14)
        Text('ðŸ“¡')
          .fontSize(14)
          .margin({ left: 16 })
        Text('ðŸ”‹')
          .fontSize(15)
          .margin({ left: 22 })
      }
      .width(46)
      .height(17)
      .margin({ right: 24, top: 25 })
      .justifyContent(FlexAlign.End)
      
      Text('ðŸ“±')
        .fontSize(16)
        .margin({ top: 18 })
        .align(Alignment.Center)
    }
    .width('100%')
    .height(52)
    .backgroundColor('#FEF7FF')
  }

  // æ ‡é¢˜æ ç»„ä»¶
  @Builder TitleBar() {
    Row() {
      // å·¦ä¾§å¤´åƒæŒ‰é’®
      Button({ type: ButtonType.Circle }) {
        Text('ðŸ‘¤')
          .fontSize(24)
      }
      .width(48)
      .height(48)
      .backgroundColor('#FEF7FF')
      .margin({ left: 4, top: 8 })

      // æ ‡é¢˜
      Text('å†…å®¹ä¸­å¿ƒ')
        .fontSize(22)
        .fontWeight(FontWeight.Normal)
        .fontColor('#1D1B20')
        .margin({ left: 12, top: 18 })
        .layoutWeight(1)

      // å³ä¾§æœç´¢æŒ‰é’®
      Button({ type: ButtonType.Circle }) {
        Text('ðŸ”')
          .fontSize(24)
      }
      .width(48)
      .height(48)
      .backgroundColor('#FEF7FF')
      .margin({ right: 4, top: 8 })
    }
    .width('100%')
    .height(64)
    .backgroundColor('#FEF7FF')
  }

  // è¿‡æ»¤å™¨æ ‡ç­¾æ 
  @Builder FilterBar() {
    Scroll() {
      Row() {
        ForEach(this.filterLabels, (item: string, index: number) => {
          Button(item) {
            Text(item)
              .fontSize(14)
              .fontWeight(FontWeight.Medium)
              .fontColor(index === this.selectedFilter ? '#4A4459' : '#49454F')
          }
          .width(67)
          .height(32)
          .backgroundColor(index === this.selectedFilter ? '#E8DEF8' : '#FEF7FF')
          .border({
            width: index === this.selectedFilter ? 0 : 1,
            color: index === this.selectedFilter ? '#00000000' : '#CAC4D0',
            style: BorderStyle.Solid
          })
          .borderRadius(8)
          .margin({ right: 8 })
          .onClick(() => {
            this.selectedFilter = index;
          })
        })
      }
      .padding({ left: 8, right: 8, top: 8, bottom: 8 })
    }
    .scrollable(ScrollDirection.Horizontal)
    .width('100%')
    .height(48)
    .backgroundColor('#FEF7FF')
  }

  // æ“ä½œæŒ‰é’®åŒºåŸŸ
  @Builder ActionButtons() {
    Row() {
      // ä¸»è¦æ“ä½œæŒ‰é’®
      Button({ type: ButtonType.Normal }) {
        Row() {
          Text('âž•')
            .fontSize(20)
          Text('æ–°å»ºå†…å®¹')
            .fontSize(14)
            .fontWeight(FontWeight.Medium)
            .fontColor('#6750A4')
            .margin({ left: 8 })
        }
      }
      .width(95)
      .height(40)
      .backgroundColor('#FEF7FF')
      .border({
        width: 1,
        color: '#6750A4',
        style: BorderStyle.Solid
      })
      .borderRadius(100)

      Blank()
        .layoutWeight(1)

      // è®¾ç½®æŒ‰é’®
      Button({ type: ButtonType.Circle }) {
        Text('âš™ï¸')
          .fontSize(24)
      }
      .width(40)
      .height(40)
      .backgroundColor('#FEF7FF')
      .border({
        width: 1,
        color: '#CAC4D0',
        style: BorderStyle.Solid
      })
      .borderRadius(100)
    }
    .width('100%')
    .height(72)
    .padding({ left: 8, right: 8 })
    .backgroundColor('#FEF7FF')
  }

  // å†…å®¹ç½‘æ ¼
  @Builder ContentGrid() {
    Grid() {
      ForEach(this.contentItems, (item: ContentItem, index: number) => {
        GridItem() {
          Column() {
            // å›¾ç‰‡åŒºåŸŸ
            Column() {
              Text('ðŸ“·')
                .fontSize(48)
            }
            .width('100%')
            .height(120)
            .justifyContent(FlexAlign.Center)
            .alignItems(HorizontalAlign.Center)
            .backgroundColor('#ECE6F0')
            .borderRadius(16)
            
            // æ–‡æœ¬åŒºåŸŸ
            Column() {
              Text(item.title)
                .fontSize(14)
                .fontWeight(FontWeight.Medium)
                .fontColor('#1D1B20')
                .maxLines(1)
                .textOverflow({ overflow: TextOverflow.Ellipsis })
              
              Text(item.time)
                .fontSize(12)
                .fontWeight(FontWeight.Normal)
                .fontColor('#49454F')
                .margin({ top: 4 })
            }
            .width('100%')
            .margin({ top: 4 })
          }
          .width('100%')
          .padding(8)
          .onClick(() => {
            // å¤„ç†å†…å®¹ç‚¹å‡»äº‹ä»¶
            console.log('ç‚¹å‡»å†…å®¹:', item.title);
          })
        }
      })
    }
    .columnsTemplate('1fr 1fr 1fr')
    .columnsGap(8)
    .rowsGap(16)
    .width('100%')
    .layoutWeight(1)
    .padding({ left: 16, right: 16, top: 0, bottom: 16 })
    .backgroundColor('#FEF7FF')
  }

  // åº•éƒ¨å¯¼èˆªæ 
  @Builder BottomNavigation() {
    Row() {
      // é¦–é¡µæ ‡ç­¾
      Column() {
        Button({ type: ButtonType.Circle }) {
          Text('ðŸ ')
            .fontSize(24)
            .fontColor(this.currentTab === 0 ? '#625B71' : '#49454F')
        }
        .width(56)
        .height(32)
        .backgroundColor(this.currentTab === 0 ? '#E8DEF8' : '#F3EDF7')
        .borderRadius(16)
        
        Text('é¦–é¡µ')
          .fontSize(12)
          .fontWeight(FontWeight.Medium)
          .fontColor(this.currentTab === 0 ? '#625B71' : '#49454F')
          .margin({ top: 6 })
      }
      .width('33.33%')
      .onClick(() => {
        this.currentTab = 0;
      })

      // å‘çŽ°æ ‡ç­¾
      Column() {
        Button({ type: ButtonType.Circle }) {
          Text('ðŸ”')
            .fontSize(24)
            .fontColor(this.currentTab === 1 ? '#625B71' : '#49454F')
        }
        .width(56)
        .height(32)
        .backgroundColor(this.currentTab === 1 ? '#E8DEF8' : '#F3EDF7')
        .borderRadius(16)
        
        Text('å‘çŽ°')
          .fontSize(12)
          .fontWeight(FontWeight.Medium)
          .fontColor(this.currentTab === 1 ? '#625B71' : '#49454F')
          .margin({ top: 6 })
      }
      .width('33.33%')
      .onClick(() => {
        this.currentTab = 1;
      })

      // æˆ‘çš„æ ‡ç­¾
      Column() {
        Button({ type: ButtonType.Circle }) {
          Text('ðŸ‘¤')
            .fontSize(24)
            .fontColor(this.currentTab === 2 ? '#625B71' : '#49454F')
        }
        .width(56)
        .height(32)
        .backgroundColor(this.currentTab === 2 ? '#E8DEF8' : '#F3EDF7')
        .borderRadius(16)
        
        Text('æˆ‘çš„')
          .fontSize(12)
          .fontWeight(FontWeight.Medium)
          .fontColor(this.currentTab === 2 ? '#625B71' : '#49454F')
          .margin({ top: 6 })
      }
      .width('33.33%')
      .onClick(() => {
        this.currentTab = 2;
      })
    }
    .width('100%')
    .height(64)
    .backgroundColor('#F3EDF7')
  }

  // åº•éƒ¨æŒ‡ç¤ºå™¨
  @Builder BottomIndicator() {
    Row() {
      // ä½¿ç”¨Divä»£æ›¿Rectangle
      Divider()
        .width(108)
        .height(4)
        .color('#1D1B20')
        .lineCap(LineCapStyle.Round)
    }
    .width('100%')
    .height(24)
    .backgroundColor('#F3EDF7')
    .justifyContent(FlexAlign.Center)
  }
}